{"ast":null,"code":"import _objectSpread from\"D:\\\\Development\\\\WorkFolder\\\\FamilyButtler\\\\Family-Buttler\\\\Web-App\\\\web-app\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\objectSpread2.js\";import _asyncToGenerator from\"D:\\\\Development\\\\WorkFolder\\\\FamilyButtler\\\\Family-Buttler\\\\Web-App\\\\web-app\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _regeneratorRuntime from\"D:\\\\Development\\\\WorkFolder\\\\FamilyButtler\\\\Family-Buttler\\\\Web-App\\\\web-app\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React from\"react\";import{useDispatch}from\"react-redux\";import apiConfig from'../_config/apiConfig.json';import{SetMenu}from\"../_redux/_appStateStore/appStoreAccessor\";export var useImageConverter=function useImageConverter(menu){var dispatch=useDispatch();var fetchData=React.useCallback(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(form){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch(apiConfig.baseUrl+apiConfig.cookingBook.imageConverter,{method:'POST',mode:'cors',body:form}).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(res){var imageString;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(res.status===200)){_context.next=9;break;}_context.t0=JSON;_context.t1=JSON;_context.next=5;return res.json();case 5:_context.t2=_context.sent;_context.t3=_context.t1.stringify.call(_context.t1,_context.t2);imageString=_context.t0.parse.call(_context.t0,_context.t3);dispatch(SetMenu(_objectSpread(_objectSpread({},menu),{},{image:\"data:image/png;base64,\"+imageString})));case 9:case\"end\":return _context.stop();}}},_callee);}));return function(_x2){return _ref2.apply(this,arguments);};}());case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref.apply(this,arguments);};}(),[dispatch,menu]);var getFormData=function getFormData(file){var formData=new FormData();formData.append(\"image\",file);return formData;};var getBase64Image=React.useCallback(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(file){var formData;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:formData=getFormData(file);_context3.next=3;return fetchData(formData);case 3:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}(),[fetchData]);var handleChange=React.useCallback(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(e){var file;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:e.preventDefault();if(!(e.target.files!==null&&e.target.files[0])){_context4.next=5;break;}file=e.target.files[0];_context4.next=5;return getBase64Image(file);case 5:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}(),[getBase64Image]);return{handleChange:handleChange};};","map":{"version":3,"sources":["D:/Development/WorkFolder/FamilyButtler/Family-Buttler/Web-App/web-app/src/_hooks/useImageConverter.ts"],"names":["React","useDispatch","apiConfig","SetMenu","useImageConverter","menu","dispatch","fetchData","useCallback","form","fetch","baseUrl","cookingBook","imageConverter","method","mode","body","then","res","status","JSON","json","stringify","imageString","parse","image","getFormData","file","formData","FormData","append","getBase64Image","handleChange","e","preventDefault","target","files"],"mappings":"yfAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,WAAT,KAA4B,aAA5B,CACA,MAAOC,CAAAA,SAAP,KAAsB,2BAAtB,CAEA,OAASC,OAAT,KAAwB,2CAAxB,CAMA,MAAO,IAAMC,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAACC,IAAD,CAAoC,CAEjE,GAAMC,CAAAA,QAAQ,CAAGL,WAAW,EAA5B,CACA,GAAMM,CAAAA,SAAS,CAAGP,KAAK,CAACQ,WAAN,0FAAkB,kBAAOC,IAAP,6IAC1BC,CAAAA,KAAK,CAACR,SAAS,CAACS,OAAV,CAAoBT,SAAS,CAACU,WAAV,CAAsBC,cAA3C,CAA2D,CAACC,MAAM,CAAE,MAAT,CAAiBC,IAAI,CAAE,MAAvB,CAA+BC,IAAI,CAAEP,IAArC,CAA3D,CAAL,CACLQ,IADK,2FACA,iBAAOC,GAAP,uIACCA,GAAG,CAACC,MAAJ,GAAe,GADhB,sCAE6BC,IAF7B,aAEwCA,IAFxC,uBAE6DF,CAAAA,GAAG,CAACG,IAAJ,EAF7D,0DAE6CC,SAF7C,+BAEQC,WAFR,aAEkCC,KAFlC,+BAIElB,QAAQ,CAACH,OAAO,gCAAKE,IAAL,MAAWoB,KAAK,CAAE,yBAA2BF,WAA7C,GAAR,CAAR,CAJF,sDADA,iEAD0B,yDAAlB,+DAUhB,CAACjB,QAAD,CAAWD,IAAX,CAVgB,CAAlB,CAYA,GAAMqB,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAACC,IAAD,CAAe,CAC/B,GAAMC,CAAAA,QAAQ,CAAG,GAAIC,CAAAA,QAAJ,EAAjB,CACAD,QAAQ,CAACE,MAAT,CAAgB,OAAhB,CAAyBH,IAAzB,EAEA,MAAOC,CAAAA,QAAP,CACH,CALD,CAOA,GAAMG,CAAAA,cAAc,CAAG/B,KAAK,CAACQ,WAAN,2FAAkB,kBAAOmB,IAAP,mIAE/BC,QAF+B,CAEpBF,WAAW,CAACC,IAAD,CAFS,wBAI/BpB,CAAAA,SAAS,CAACqB,QAAD,CAJsB,yDAAlB,iEAMrB,CAACrB,SAAD,CANqB,CAAvB,CAQA,GAAMyB,CAAAA,YAAY,CAAGhC,KAAK,CAACQ,WAAN,2FAAkB,kBAAOyB,CAAP,+HACnCA,CAAC,CAACC,cAAF,GADmC,KAEhCD,CAAC,CAACE,MAAF,CAASC,KAAT,GAAmB,IAAnB,EAA2BH,CAAC,CAACE,MAAF,CAASC,KAAT,CAAe,CAAf,CAFK,2BAIzBT,IAJyB,CAIlBM,CAAC,CAACE,MAAF,CAASC,KAAT,CAAe,CAAf,CAJkB,wBAMzBL,CAAAA,cAAc,CAACJ,IAAD,CANW,yDAAlB,iEAQnB,CAACI,cAAD,CARmB,CAArB,CAUA,MAAO,CACHC,YAAY,CAAZA,YADG,CAAP,CAGH,CA3CM","sourcesContent":["import React from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport apiConfig from '../_config/apiConfig.json'\r\nimport { IMenu } from \"../_interfaces/IMenu\";\r\nimport { SetMenu } from \"../_redux/_appStateStore/appStoreAccessor\";\r\n\r\nexport interface IImageUploadResult{\r\n    handleChange: (e: React.ChangeEvent<HTMLInputElement>) => Promise<void>\r\n}\r\n\r\nexport const useImageConverter = (menu: IMenu): IImageUploadResult =>{\r\n  \r\n    const dispatch = useDispatch();\r\n    const fetchData = React.useCallback(async (form: any) =>{\r\n        await fetch(apiConfig.baseUrl + apiConfig.cookingBook.imageConverter, {method: 'POST', mode: 'cors', body: form})\r\n        .then(async (res) => {\r\n            if(res.status === 200){\r\n                const imageString:string = JSON.parse(JSON.stringify(await res.json()))\r\n\r\n                dispatch(SetMenu({...menu, image: \"data:image/png;base64,\" + imageString}))\r\n               \r\n            }\r\n        })\r\n    },[dispatch, menu])\r\n\r\n    const getFormData = (file: File) =>{\r\n        const formData = new FormData();\r\n        formData.append(\"image\", file)\r\n        \r\n        return formData\r\n    }\r\n\r\n    const getBase64Image = React.useCallback(async (file: File) => {\r\n        \r\n        const formData = getFormData(file)\r\n        \r\n        await fetchData(formData)\r\n       \r\n    },[fetchData])\r\n\r\n    const handleChange = React.useCallback(async (e: React.ChangeEvent<HTMLInputElement>) =>{\r\n        e.preventDefault()\r\n        if(e.target.files !== null && e.target.files[0]){\r\n\r\n            const file = e.target.files[0]\r\n\r\n            await getBase64Image(file)  \r\n        }\r\n    },[getBase64Image])\r\n\r\n    return {   \r\n        handleChange\r\n    }\r\n} "]},"metadata":{},"sourceType":"module"}