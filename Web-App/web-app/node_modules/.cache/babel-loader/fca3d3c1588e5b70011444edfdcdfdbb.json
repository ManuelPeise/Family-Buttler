{"ast":null,"code":"import _asyncToGenerator from\"D:\\\\Development\\\\WorkFolder\\\\FamilyButtler\\\\Family-Buttler\\\\Web-App\\\\web-app\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _slicedToArray from\"D:\\\\Development\\\\WorkFolder\\\\FamilyButtler\\\\Family-Buttler\\\\Web-App\\\\web-app\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _regeneratorRuntime from\"D:\\\\Development\\\\WorkFolder\\\\FamilyButtler\\\\Family-Buttler\\\\Web-App\\\\web-app\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React from'react';import useApi from'../../_hooks/useApi';import apiConfig from'../../_config/apiConfig.json';import{SetMenuCollection,SetPageTitle}from'../../_redux/_appStateStore/appStoreAccessor';import{useDispatch}from'react-redux';import MenuLayout from'./MenuLayout';import{useImageUpload}from'../../_hooks/useImageUpload';import{jsx as _jsx}from\"react/jsx-runtime\";var EditMenuDataService=function EditMenuDataService(){var _menuDataService$item6;var dispatch=useDispatch();var _React$useState=React.useState(0),_React$useState2=_slicedToArray(_React$useState,2),selectedMenuId=_React$useState2[0],setSelectedMenuId=_React$useState2[1];var menuDataService=useApi({serviceUri:apiConfig.baseUrl+apiConfig.cookingBook.getMenuCollection,params:null});var valueDataService=useApi({serviceUri:apiConfig.baseUrl+apiConfig.i18nController+\"cookingbook_cookingbookEn\",params:null});var imageDataService=useImageUpload(\"\");var handleMenuSelect=React.useCallback(function(id){if(id!==null)setSelectedMenuId(id);},[setSelectedMenuId]);var selectedMenu=React.useMemo(function(){var _menuDataService$item,_menuDataService$item2,_menuDataService$item3;return(_menuDataService$item=(_menuDataService$item2=menuDataService.items[0])===null||_menuDataService$item2===void 0?void 0:(_menuDataService$item3=_menuDataService$item2.menuCollection)===null||_menuDataService$item3===void 0?void 0:_menuDataService$item3.find(function(menu){return menu.id===selectedMenuId;}))!==null&&_menuDataService$item!==void 0?_menuDataService$item:{};},[selectedMenuId,menuDataService]);var saveOrUpdateRecipe=React.useCallback(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(menu){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return menuDataService.post({serviceUri:apiConfig.baseUrl+apiConfig.cookingBook.addOrUpdateRecipe,method:'POST',params:menu}).then(function(){setSelectedMenuId(0);});case 2:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}(),[]);var component=React.useMemo(function(){var _menuDataService$item4,_menuDataService$item5;var config={isReadOnly:false,hasFilter:true,hasMenuList:true,selectedMenuId:selectedMenuId,componentKey:'edit'};return/*#__PURE__*/_jsx(MenuLayout,{layoutConfig:config,selectedMenu:selectedMenu,menuCollection:(_menuDataService$item4=(_menuDataService$item5=menuDataService.items[0])===null||_menuDataService$item5===void 0?void 0:_menuDataService$item5.menuCollection)!==null&&_menuDataService$item4!==void 0?_menuDataService$item4:[],values:valueDataService.items[0],handleSelectMenu:handleMenuSelect,handleSave:saveOrUpdateRecipe});},[menuDataService.items,valueDataService.items,selectedMenuId,selectedMenu,handleMenuSelect,saveOrUpdateRecipe]);if(menuDataService.items[0]===null){return null;}if(valueDataService.items[0]===null||valueDataService.items[0]===undefined){return null;}dispatch(SetMenuCollection((_menuDataService$item6=menuDataService.items[0])===null||_menuDataService$item6===void 0?void 0:_menuDataService$item6.menuCollection));dispatch(SetPageTitle(valueDataService.items[0].pageTitleEdit));return component;};export default EditMenuDataService;","map":{"version":3,"sources":["D:/Development/WorkFolder/FamilyButtler/Family-Buttler/Web-App/web-app/src/_pages/_cookingBook/EditMenuDataService.tsx"],"names":["React","useApi","apiConfig","SetMenuCollection","SetPageTitle","useDispatch","MenuLayout","useImageUpload","EditMenuDataService","dispatch","useState","selectedMenuId","setSelectedMenuId","menuDataService","serviceUri","baseUrl","cookingBook","getMenuCollection","params","valueDataService","i18nController","imageDataService","handleMenuSelect","useCallback","id","selectedMenu","useMemo","items","menuCollection","find","menu","saveOrUpdateRecipe","post","addOrUpdateRecipe","method","then","component","config","isReadOnly","hasFilter","hasMenuList","componentKey","undefined","pageTitleEdit"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport useApi from '../../_hooks/useApi'\r\nimport { IMenu, IMenuResponse } from '../../_interfaces/IMenu'\r\nimport apiConfig from '../../_config/apiConfig.json'\r\nimport { SetMenuCollection, SetPageTitle } from '../../_redux/_appStateStore/appStoreAccessor'\r\nimport { useDispatch } from 'react-redux'\r\nimport MenuLayout from './MenuLayout'\r\nimport { IMenuLayoutConfig } from './interfaces/IMenueLayoutConfig'\r\nimport { ICookingBookValues } from '../../_interfaces/ICookingBookValues'\r\nimport { useImageUpload } from '../../_hooks/useImageUpload'\r\n\r\nconst EditMenuDataService: React.FC= () =>{\r\n\r\n    const dispatch = useDispatch();\r\n    \r\n    const [selectedMenuId, setSelectedMenuId] = React.useState<number>(0)\r\n\r\n    const menuDataService = useApi<IMenuResponse>({serviceUri: apiConfig.baseUrl + apiConfig.cookingBook.getMenuCollection, params: null})\r\n    \r\n    const valueDataService = useApi<ICookingBookValues>({serviceUri: apiConfig.baseUrl + apiConfig.i18nController + \"cookingbook_cookingbookEn\", params: null}) \r\n    \r\n    const imageDataService = useImageUpload(\"\")\r\n    \r\n    const handleMenuSelect = React.useCallback((id: number | null) =>{\r\n        if(id !== null)\r\n        setSelectedMenuId(id)\r\n    },[setSelectedMenuId])\r\n\r\n    const selectedMenu = React.useMemo(() =>{\r\n        return menuDataService.items[0]?.menuCollection?.find(menu => menu.id === selectedMenuId) ?? {} as IMenu\r\n    },[selectedMenuId, menuDataService])\r\n    \r\n    const saveOrUpdateRecipe = React.useCallback(async (menu: IMenu) =>{\r\n        await menuDataService.post({serviceUri: apiConfig.baseUrl + apiConfig.cookingBook.addOrUpdateRecipe, method: 'POST', params: menu})\r\n        .then(() =>{\r\n            setSelectedMenuId(0)\r\n        })\r\n    },[])\r\n\r\n    const component = React.useMemo(() =>{\r\n       \r\n        const config: IMenuLayoutConfig = {\r\n            isReadOnly: false, \r\n            hasFilter: true, \r\n            hasMenuList: true,\r\n            selectedMenuId: selectedMenuId,\r\n            componentKey: 'edit'\r\n            }\r\n                \r\n        return <MenuLayout \r\n                    layoutConfig={config} \r\n                    selectedMenu={selectedMenu}\r\n                    menuCollection={menuDataService.items[0]?.menuCollection?? []}\r\n                    values={valueDataService.items[0]}\r\n                    handleSelectMenu={handleMenuSelect} \r\n                    handleSave={saveOrUpdateRecipe}/>\r\n         \r\n    },[menuDataService.items, valueDataService.items, selectedMenuId, selectedMenu, handleMenuSelect, saveOrUpdateRecipe])\r\n\r\n    if(menuDataService.items[0] === null){\r\n\r\n        return null\r\n    }\r\n\r\n    if(valueDataService.items[0] === null || valueDataService.items[0] === undefined){\r\n        return null\r\n    }\r\n\r\n    dispatch(SetMenuCollection(menuDataService.items[0]?.menuCollection))\r\n    dispatch(SetPageTitle(valueDataService.items[0].pageTitleEdit))\r\n    return component\r\n}\r\n\r\nexport default EditMenuDataService\r\n"]},"metadata":{},"sourceType":"module"}