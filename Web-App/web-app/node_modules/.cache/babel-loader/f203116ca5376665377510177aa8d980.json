{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport React from 'react';\n\nconst useApi = options => {\n  _s();\n\n  const [apiOptions, setApiOptions] = React.useState(options);\n  const [dataBound, setDataBound] = React.useState(false);\n  const [items, setItems] = React.useState([]);\n  const [isLoading, setIsloading] = React.useState(false);\n\n  const resolve = async res => {\n    Promise.resolve(res.json()).then(data => {\n      var responsItems = [];\n\n      if (Array.isArray(data)) {\n        responsItems = JSON.parse(JSON.stringify(data));\n        setItems(responsItems);\n        return;\n      }\n\n      var item = JSON.parse(JSON.stringify(data));\n      responsItems.push(item);\n      setItems(responsItems);\n    });\n    setDataBound(true);\n  };\n\n  const get = async options => {\n    if (options !== undefined) {\n      setApiOptions({ ...options,\n        ...apiOptions\n      });\n    }\n\n    setIsloading(true);\n    await fetch(apiOptions.serviceUri, {\n      method: 'GET',\n      mode: 'cors'\n    }).then(async res => {\n      if (res.status === 200) {\n        resolve(res);\n      }\n    }).finally(() => {\n      setIsloading(false);\n    });\n  };\n\n  const post = async options => {\n    if (options !== undefined) {\n      setApiOptions({ ...options,\n        ...apiOptions\n      });\n    }\n\n    setIsloading(true);\n    await fetch(apiOptions.serviceUri, {\n      method: 'POST',\n      mode: 'cors',\n      body: apiOptions.params\n    }).then(async res => {\n      if (res.status === 200) {}\n    }).finally(() => {\n      setIsloading(false);\n    });\n  };\n\n  const unbindData = () => {\n    setItems([]);\n  };\n\n  React.useEffect(() => {\n    console.log(\"fetch\");\n\n    const fetchData = async () => {\n      await get();\n    };\n\n    if (apiOptions.params === null) {\n      fetchData();\n    }\n  }, []);\n  const result = {\n    items,\n    isLoading,\n    dataBound,\n    get,\n    post,\n    unbindData\n  };\n  return result;\n};\n\n_s(useApi, \"vCsXZagNuUSSViDuM4FfEWvl1i4=\");\n\nexport default useApi;","map":{"version":3,"sources":["D:/Development/WorkFolder/FamilyButtler/Family-Buttler/Web-App/web-app/src/_hooks/useApi.ts"],"names":["React","useApi","options","apiOptions","setApiOptions","useState","dataBound","setDataBound","items","setItems","isLoading","setIsloading","resolve","res","Promise","json","then","data","responsItems","Array","isArray","JSON","parse","stringify","item","push","get","undefined","fetch","serviceUri","method","mode","status","finally","post","body","params","unbindData","useEffect","console","log","fetchData","result"],"mappings":"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","sourcesContent":["import React from 'react'\r\n\r\nexport interface IApiOptions{\r\n    serviceUri: string\r\n    method?: 'GET'|'POST'\r\n    params?: any | null\r\n}\r\n\r\ninterface IApiResult<TItem>{\r\n    items: TItem[]\r\n    isLoading: boolean\r\n    dataBound: boolean\r\n    unbindData: () => void\r\n    get: (options?: IApiOptions) => Promise<void>\r\n    post: (options?: IApiOptions) => Promise<void>\r\n}\r\n\r\nconst useApi = <TItem>(options: IApiOptions) : IApiResult<TItem> => {\r\n\r\n    const [apiOptions, setApiOptions] = React.useState<IApiOptions>(options)\r\n    const [dataBound, setDataBound] = React.useState<boolean>(false)\r\n    const [items, setItems] = React.useState<TItem[]>([])\r\n    const [isLoading, setIsloading] = React.useState<boolean>(false)\r\n   \r\n\r\n    const resolve = async (res: Response) =>{\r\n\r\n        Promise.resolve(res.json())\r\n        .then((data) =>{\r\n\r\n            var responsItems = [] as TItem[]\r\n\r\n            if(Array.isArray(data)){\r\n                responsItems = JSON.parse(JSON.stringify(data))\r\n            \r\n                setItems(responsItems)\r\n\r\n                return\r\n            }\r\n           \r\n            var item: TItem = JSON.parse(JSON.stringify(data))\r\n\r\n            responsItems.push(item)\r\n\r\n            setItems(responsItems)\r\n        });\r\n\r\n        setDataBound(true)\r\n    }\r\n\r\n    const get = async (options?: IApiOptions) =>{\r\n\r\n        if(options !== undefined){\r\n            setApiOptions({...options, ...apiOptions})\r\n        }\r\n        \r\n        setIsloading(true)\r\n        await fetch(apiOptions.serviceUri, {method: 'GET', mode: 'cors'})\r\n        .then(async (res) => {\r\n\r\n            if(res.status === 200){\r\n\r\n              resolve(res);\r\n\r\n            }\r\n        }).finally(() =>{\r\n            \r\n            setIsloading(false)\r\n        })\r\n        \r\n    }\r\n\r\n    const post = async (options?: IApiOptions) => {\r\n\r\n        \r\n        if(options !== undefined){\r\n            setApiOptions({...options, ...apiOptions})\r\n        }\r\n\r\n        setIsloading(true)\r\n\r\n        await fetch(apiOptions.serviceUri, {method: 'POST', mode:'cors', body: apiOptions.params})\r\n        \r\n        .then(async (res) =>{\r\n            if(res.status === 200){\r\n\r\n            }\r\n        }).finally(() =>{\r\n            setIsloading(false)\r\n        })\r\n    }\r\n\r\n    const unbindData = () =>{\r\n        setItems([])\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        console.log(\"fetch\")\r\n        const fetchData = async () => {\r\n            \r\n            await get();\r\n        }\r\n\r\n        if(apiOptions.params === null){\r\n\r\n            fetchData();\r\n        }\r\n\r\n    },[])\r\n\r\n    const result: IApiResult<TItem> = {\r\n        items,\r\n        isLoading,\r\n        dataBound,\r\n        get,\r\n        post,\r\n        unbindData\r\n        \r\n    }\r\n    \r\n\r\n    return result;\r\n}\r\n\r\nexport default useApi\r\n\r\n"]},"metadata":{},"sourceType":"module"}