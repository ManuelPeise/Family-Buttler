{"ast":null,"code":"import _asyncToGenerator from\"D:\\\\Development\\\\WorkFolder\\\\FamilyButtler\\\\Family-Buttler\\\\Web-App\\\\web-app\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _slicedToArray from\"D:\\\\Development\\\\WorkFolder\\\\FamilyButtler\\\\Family-Buttler\\\\Web-App\\\\web-app\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _regeneratorRuntime from\"D:\\\\Development\\\\WorkFolder\\\\FamilyButtler\\\\Family-Buttler\\\\Web-App\\\\web-app\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React from\"react\";import apiConfig from'../_config/apiConfig.json';export var useImageUpload=function useImageUpload(src){var _React$useState=React.useState(),_React$useState2=_slicedToArray(_React$useState,2),image=_React$useState2[0],setImage=_React$useState2[1];var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(form){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch(apiConfig.baseUrl+apiConfig.cookingBook.imageConverter,{method:'POST',mode:'cors',body:form}).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(res){var bytes;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(res.status===200)){_context.next=9;break;}_context.t0=JSON;_context.t1=JSON;_context.next=5;return res.json();case 5:_context.t2=_context.sent;_context.t3=_context.t1.stringify.call(_context.t1,_context.t2);bytes=_context.t0.parse.call(_context.t0,_context.t3);setImage(bytes);case 9:case\"end\":return _context.stop();}}},_callee);}));return function(_x2){return _ref2.apply(this,arguments);};}());case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchData(_x){return _ref.apply(this,arguments);};}();var getFormData=function getFormData(file){var formData=new FormData();formData.append(\"image\",file);return formData;};var getBase64Image=React.useCallback(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(file){var formData;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:formData=getFormData(file);_context3.next=3;return fetchData(formData);case 3:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}(),[]);var handleChange=React.useCallback(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(e){var file;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:e.preventDefault();if(!(e.target.files!==null&&e.target.files[0])){_context4.next=5;break;}file=e.target.files[0];_context4.next=5;return getBase64Image(file);case 5:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}(),[getBase64Image]);return{image:image,handleChange:handleChange};};","map":{"version":3,"sources":["D:/Development/WorkFolder/FamilyButtler/Family-Buttler/Web-App/web-app/src/_hooks/useImageUpload.ts"],"names":["React","apiConfig","useImageUpload","src","useState","image","setImage","fetchData","form","fetch","baseUrl","cookingBook","imageConverter","method","mode","body","then","res","status","JSON","json","stringify","bytes","parse","getFormData","file","formData","FormData","append","getBase64Image","useCallback","handleChange","e","preventDefault","target","files"],"mappings":"0fAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,SAAP,KAAsB,2BAAtB,CAOA,MAAO,IAAMC,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAACC,GAAD,CAAkD,CAE5E,oBAA0BH,KAAK,CAACI,QAAN,EAA1B,oDAAOC,KAAP,qBAAcC,QAAd,qBAEA,GAAMC,CAAAA,SAAS,0FAAG,kBAAOC,IAAP,6IACRC,CAAAA,KAAK,CAACR,SAAS,CAACS,OAAV,CAAoBT,SAAS,CAACU,WAAV,CAAsBC,cAA3C,CAA2D,CAACC,MAAM,CAAE,MAAT,CAAiBC,IAAI,CAAE,MAAvB,CAA+BC,IAAI,CAAEP,IAArC,CAA3D,CAAL,CACLQ,IADK,2FACA,iBAAOC,GAAP,iIACCA,GAAG,CAACC,MAAJ,GAAe,GADhB,sCAGsBC,IAHtB,aAGiCA,IAHjC,uBAGsDF,CAAAA,GAAG,CAACG,IAAJ,EAHtD,0DAGsCC,SAHtC,+BAGQC,KAHR,aAG2BC,KAH3B,+BAKEjB,QAAQ,CAACgB,KAAD,CAAR,CALF,sDADA,iEADQ,yDAAH,kBAATf,CAAAA,SAAS,4CAAf,CAYA,GAAMiB,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAACC,IAAD,CAAe,CAC/B,GAAMC,CAAAA,QAAQ,CAAG,GAAIC,CAAAA,QAAJ,EAAjB,CACAD,QAAQ,CAACE,MAAT,CAAgB,OAAhB,CAAyBH,IAAzB,EAEA,MAAOC,CAAAA,QAAP,CACH,CALD,CAOA,GAAMG,CAAAA,cAAc,CAAG7B,KAAK,CAAC8B,WAAN,2FAAkB,kBAAOL,IAAP,mIAE/BC,QAF+B,CAEpBF,WAAW,CAACC,IAAD,CAFS,wBAI/BlB,CAAAA,SAAS,CAACmB,QAAD,CAJsB,yDAAlB,iEAMrB,EANqB,CAAvB,CAQA,GAAMK,CAAAA,YAAY,CAAG/B,KAAK,CAAC8B,WAAN,2FAAkB,kBAAOE,CAAP,+HACnCA,CAAC,CAACC,cAAF,GADmC,KAGhCD,CAAC,CAACE,MAAF,CAASC,KAAT,GAAmB,IAAnB,EAA2BH,CAAC,CAACE,MAAF,CAASC,KAAT,CAAe,CAAf,CAHK,2BAKzBV,IALyB,CAKlBO,CAAC,CAACE,MAAF,CAASC,KAAT,CAAe,CAAf,CALkB,wBAOzBN,CAAAA,cAAc,CAACJ,IAAD,CAPW,yDAAlB,iEASnB,CAACI,cAAD,CATmB,CAArB,CAWA,MAAO,CACHxB,KAAK,CAALA,KADG,CAEH0B,YAAY,CAAZA,YAFG,CAAP,CAIH,CA9CM","sourcesContent":["import React from \"react\";\r\nimport apiConfig from '../_config/apiConfig.json'\r\n\r\nexport interface IImageUploadResult{\r\n    image: Blob | undefined\r\n    handleChange: (e: React.ChangeEvent<HTMLInputElement>) => Promise<void>\r\n}\r\n\r\nexport const useImageUpload = (src: ArrayBuffer | string): IImageUploadResult =>{\r\n\r\n    const [image, setImage] = React.useState<Blob>();    \r\n\r\n    const fetchData = async (form: any) =>{\r\n        await fetch(apiConfig.baseUrl + apiConfig.cookingBook.imageConverter, {method: 'POST', mode: 'cors', body: form})\r\n        .then(async (res) => {\r\n            if(res.status === 200){\r\n\r\n                const bytes: Blob = JSON.parse(JSON.stringify(await res.json()))\r\n                \r\n                setImage(bytes)\r\n            }\r\n        })\r\n    }\r\n\r\n    const getFormData = (file: File) =>{\r\n        const formData = new FormData();\r\n        formData.append(\"image\", file)\r\n        \r\n        return formData\r\n    }\r\n\r\n    const getBase64Image = React.useCallback(async (file: File) => {\r\n    \r\n        const formData = getFormData(file)\r\n        \r\n        await fetchData(formData)\r\n        \r\n    },[])\r\n\r\n    const handleChange = React.useCallback(async (e: React.ChangeEvent<HTMLInputElement>) =>{\r\n        e.preventDefault()\r\n\r\n        if(e.target.files !== null && e.target.files[0]){\r\n\r\n            const file = e.target.files[0]\r\n\r\n            await getBase64Image(file)  \r\n        }\r\n    },[getBase64Image])\r\n\r\n    return {\r\n        image,\r\n        handleChange\r\n    }\r\n} "]},"metadata":{},"sourceType":"module"}